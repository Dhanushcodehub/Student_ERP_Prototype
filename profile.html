<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Student ERP ‚Ä¢ Profile & Settings</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

  <!-- Tailwind setup -->
  <script>
    tailwind = { config: { theme: { extend: {
      colors: {
        accent: { DEFAULT: '#4da6ff', light: '#e6f2ff' },
        grayish: { 50:'#f9f9f9', 100:'#f5f5f5', 600:'#666666' }
      }
    }}}};
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root { --accent: #4da6ff; --accent-light: #e6f2ff; --gray-100: #f5f5f5; --gray-600:#666666; }
    body { background:#ffffff; color:#111827; font-family: 'Roboto', system-ui, -apple-system, Segoe UI, Arial, sans-serif; }
    .heading { font-family:'Poppins', sans-serif; }
    .card { border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.06); background: #fff; }
    .btn-gradient { background: linear-gradient(90deg, #4da6ff 0%, #3399ff 100%); color:white; transition: transform .15s ease, filter .15s ease; }
    .btn-gradient:hover { filter: brightness(0.97); transform: translateY(-1px); }
    .btn-gradient:active { transform: translateY(0); }
    .tab-active { background:#e6f2ff; color:#0f172a; border-color:#4da6ff; }
    .avatar-bg { background: radial-gradient(circle at 30% 30%, #e6f2ff 0%, #cfe8ff 80%); }
    .toggle { transition: all .2s ease; }
    .toast-enter { animation: toast-in .25s ease-out both; }
    @keyframes toast-in { from { transform: translateY(-8px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    /* Hide default file inputs for custom buttons */
    input[type="file"].file-hidden { position: absolute; opacity: 0; width: 0; height: 0; pointer-events: none; }
  </style>
</head>
<body class="antialiased">

  <!-- Top Navigation -->
  <nav class="fixed top-0 inset-x-0 bg-white z-50 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8">
      <div class="h-16 flex items-center justify-between">
        <!-- Left: Logo -->
        <div class="flex items-center gap-3">
          <div class="w-9 h-9 rounded-xl bg-accent-light flex items-center justify-center">
            <!-- Simple flat logo -->
            <svg width="20" height="20" viewBox="0 0 24 24" class="text-accent" fill="currentColor" aria-hidden="true">
              <path d="M12 2l9 4.5v10.9a2 2 0 0 1-1.2 1.84l-6.8 3.02a2 2 0 0 1-1.6 0L4.6 19.24A2 2 0 0 1 3.4 17.4V6.5L12 2zm0 2.2L5.4 7l6.6 2.95L18.6 7 12 4.2zM5.4 9.17v8.2l6.2 2.76v-8.17L5.4 9.17zm13.2 0l-6.2 2.79v8.17l6.2-2.76v-8.2z"/>
            </svg>
          </div>
          <span class="heading text-slate-800 text-lg">Student ERP</span>
        </div>

        <!-- Center: Title (hide on very small) -->
        <div class="hidden sm:block heading text-slate-900 text-base">Profile &amp; Settings</div>

        <!-- Right: Icons -->
        <div class="relative flex items-center gap-2">
          <!-- Notifications -->
          <button id="btnNotifications" class="icon-btn relative mr-5" aria-label="Notifications">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0119.5 9.75v-.75a7.5 7.5 0 10-15 0v.75c0 1.97-.722 3.887-1.811 5.347.878.332 1.79.608 2.727.824m9.441 1.161a8.973 8.973 0 01-6.357 0m6.357 0a3 3 0 11-6.357 0" />
          </svg>
          <span class="absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full"></span>
        </button>
          <div id="notifMenu" class="hidden absolute right-16 top-14 w-72 card p-3">
            <div class="flex items-center justify-between mb-2">
              <p class="heading text-slate-800">Notifications</p>
              <button id="clearNotifs" class="text-xs text-accent hover:underline">Clear</button>
            </div>
            <ul class="space-y-2 text-sm">
              <li class="p-2 rounded-lg bg-accent-light/60">New grade posted for CS301.</li>
              <li class="p-2 rounded-lg bg-grayish-100">Advisor updated office hours.</li>
              <li class="p-2 rounded-lg bg-grayish-100">Library book due in 2 days.</li>
            </ul>
          </div>

          <!-- Profile menu -->
          <button id="btnProfile" class="icon-btn" aria-label="Profile">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15.75 6.75a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.5 19.5a8.999 8.999 0 0115 0" />
          </svg>
        </button>
          <div id="profileMenu" class="hidden absolute right-0 top-14 w-48 card p-2">
            <a href="#profile" class="block px-3 py-2 rounded-lg hover:bg-grayish-100">View profile</a>
            <button id="demoSignOut" class="w-full text-left px-3 py-2 rounded-lg hover:bg-grayish-100">Sign out (demo)</button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Toasts -->
  <div id="toast" class="fixed top-20 right-5 space-y-2 z-[60]"></div>

  <!-- Main -->
  <main class="pt-24 pb-12">
    <div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
        <!-- Left: Profile Summary Card -->
        <aside class="md:col-span-4">
          <div class="card p-6">
            <!-- Photo -->
            <div class="relative w-36 h-36 mx-auto rounded-full ring-4 ring-white shadow-md overflow-hidden avatar-bg flex items-center justify-center" id="avatarBox">
              <!-- Placeholder icon -->
              <svg id="avatarIcon" xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-slate-400" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M12 12c2.761 0 5-2.462 5-5.5S14.761 1 12 1 7 3.462 7 6.5 9.239 12 12 12zm0 2c-4.418 0-8 2.91-8 6.5V23h16v-2.5c0-3.59-3.582-6.5-8-6.5z"/>
              </svg>
              <!-- Upload button -->
              <button id="uploadAvatarBtn" class="absolute bottom-2 right-2 rounded-full bg-accent text-white p-2 shadow-md hover:shadow-lg" title="Upload photo">‚¨ÜÔ∏è</button>
            </div>
            <input id="avatarInput" type="file" accept="image/*" class="file-hidden" />

            <!-- Name & details -->
            <div class="text-center mt-5">
              <h1 id="studentName" class="heading text-xl text-slate-900">Alex Johnson</h1>
              <p class="text-sm text-grayish-600 mt-1">Roll No: <span id="rollNo">21CS045</span></p>
            </div>

            <div class="mt-5 grid grid-cols-1 gap-3">
              <div class="p-3 rounded-xl bg-accent-light">
                <p class="text-xs text-grayish-600">Course / Year / Department</p>
                <p class="font-medium">B.Tech / 3rd Year / CSE</p>
              </div>
              <div class="p-3 rounded-xl bg-grayish-100">
                <p class="text-xs text-grayish-600">Academic Advisor</p>
                <p class="font-medium">Dr. Meera Shah</p>
              </div>
            </div>

            <button id="editProfileBtn" class="btn-gradient w-full mt-6 py-2.5 rounded-xl font-medium">‚úèÔ∏è Edit Profile</button>
          </div>
        </aside>

        <!-- Right: Tabs -->
        <section class="md:col-span-8">
          <div class="card p-4 md:p-6">
            <!-- Tabs: Mobile dropdown -->
            <div class="sm:hidden mb-3">
              <label for="mobileTabs" class="sr-only">Select section</label>
              <select id="mobileTabs" class="w-full rounded-xl border border-gray-200 bg-white px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent">
                <option value="personal">Personal Info</option>
                <option value="academic">Academic Info</option>
                <option value="contact">Contact Info Update</option>
                <option value="security">Security Settings</option>
              </select>
            </div>

            <!-- Tabs: Desktop -->
            <div class="hidden sm:flex gap-2">
              <button data-tab="personal" class="tab-btn px-4 py-2 rounded-full border border-transparent hover:bg-grayish-100">Personal Info</button>
              <button data-tab="academic" class="tab-btn px-4 py-2 rounded-full border border-transparent hover:bg-grayish-100">Academic Info</button>
              <button data-tab="contact" class="tab-btn px-4 py-2 rounded-full border border-transparent hover:bg-grayish-100">Contact Info Update</button>
              <button data-tab="security" class="tab-btn px-4 py-2 rounded-full border border-transparent hover:bg-grayish-100">Security Settings</button>
            </div>

            <!-- Divider -->
            <div class="mt-4 border-t border-gray-100"></div>

            <!-- Panels -->
            <div class="mt-5">
              <!-- Personal Info -->
              <section id="tab-personal" class="space-y-5">
                <header class="flex items-center gap-2">
                  <div class="w-2 h-2 rounded-full bg-accent"></div>
                  <h2 class="heading text-slate-900 text-lg">Personal Info</h2>
                </header>

                <form id="personalForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label class="text-sm text-grayish-600">Name</label>
                    <input id="pi-name" type="text" value="Alex Johnson" class="mt-1 w-full rounded-xl border border-gray-200 px-3 py-2 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-accent" />
                  </div>
                  <div>
                    <label class="text-sm text-grayish-600">Email</label>
                    <input id="pi-email" type="email" value="alex.johnson@example.edu" class="mt-1 w-full rounded-xl border border-gray-200 px-3 py-2 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-accent" />
                  </div>
                  <div>
                    <label class="text-sm text-grayish-600">Phone</label>
                    <input id="pi-phone" type="tel" value="+1 555 0134" class="mt-1 w-full rounded-xl border border-gray-200 px-3 py-2 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-accent" />
                  </div>
                  <div class="md:col-span-2">
                    <label class="text-sm text-grayish-600">Address</label>
                    <input id="pi-address" type="text" value="221B Campus Lane, Dorm 5, Springfield" class="mt-1 w-full rounded-xl border border-gray-200 px-3 py-2 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-accent" />
                  </div>

                  <!-- ID Proof Upload -->
                  <div class="md:col-span-2">
                    <label class="text-sm text-grayish-600">Upload ID Proof</label>
                    <div class="mt-1 flex flex-col sm:flex-row items-start sm:items-center gap-3">
                      <input id="idProofInput" type="file" accept=".pdf,.png,.jpg,.jpeg" class="file-hidden" />
                      <button id="idProofBtn" type="button" class="px-4 py-2 rounded-xl border border-gray-200 hover:bg-grayish-100">‚¨ÜÔ∏è Choose file</button>
                      <span id="idProofName" class="text-sm text-grayish-600">No file chosen</span>
                      <button id="idProofClear" type="button" class="hidden text-sm text-red-600 hover:underline">Remove</button>
                    </div>
                  </div>

                  <div class="md:col-span-2">
                    <button class="btn-gradient px-5 py-2.5 rounded-xl font-medium" type="submit">Save Changes</button>
                  </div>
                </form>
              </section>

              <!-- Academic Info -->
              <section id="tab-academic" class="hidden space-y-5">
                <header class="flex items-center gap-2">
                  <div class="w-2 h-2 rounded-full bg-accent"></div>
                  <h2 class="heading text-slate-900 text-lg">Academic Info</h2>
                </header>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div class="p-4 rounded-2xl bg-accent-light">
                    <p class="text-xs text-grayish-600">Roll No</p>
                    <p class="text-lg font-medium">21CS045</p>
                  </div>
                  <div class="p-4 rounded-2xl bg-grayish-100">
                    <p class="text-xs text-grayish-600">Course</p>
                    <p class="text-lg font-medium">B.Tech (Computer Science)</p>
                  </div>
                  <div class="p-4 rounded-2xl bg-grayish-100">
                    <p class="text-xs text-grayish-600">Year</p>
                    <p class="text-lg font-medium">3rd Year</p>
                  </div>
                  <div class="p-4 rounded-2xl bg-accent-light">
                    <p class="text-xs text-grayish-600">Department</p>
                    <p class="text-lg font-medium">CSE</p>
                  </div>
                </div>

                <div class="p-4 rounded-2xl bg-white border border-gray-100">
                  <p class="text-xs text-grayish-600">Academic Advisor</p>
                  <p class="text-base font-medium">Dr. Meera Shah</p>
                  <p class="text-sm text-grayish-600">meera.shah@example.edu ‚Ä¢ Room C-210</p>
                </div>
              </section>

              <!-- Contact Info Update -->
              <section id="tab-contact" class="hidden space-y-5">
                <header class="flex items-center gap-2">
                  <div class="w-2 h-2 rounded-full bg-accent"></div>
                  <h2 class="heading text-slate-900 text-lg">Contact Info Update</h2>
                </header>

                <form id="contactForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label class="text-sm text-grayish-600">Phone</label>
                    <input id="ci-phone" type="tel" value="+1 555 0134" class="mt-1 w-full rounded-xl border border-gray-200 px-3 py-2 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-accent" />
                  </div>
                  <div>
                    <label class="text-sm text-grayish-600">Email</label>
                    <input id="ci-email" type="email" value="alex.johnson@example.edu" class="mt-1 w-full rounded-xl border border-gray-200 px-3 py-2 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-accent" />
                  </div>
                  <div class="md:col-span-2">
                    <label class="text-sm text-grayish-600">Emergency Contact</label>
                    <input id="ci-emergency" type="text" value="Jamie Johnson (+1 555 0177)" class="mt-1 w-full rounded-xl border border-gray-200 px-3 py-2 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-accent" />
                  </div>
                  <div class="md:col-span-2">
                    <button class="btn-gradient px-5 py-2.5 rounded-xl font-medium" type="submit">Save Contact</button>
                  </div>
                </form>
              </section>

              <!-- Security Settings -->
              <section id="tab-security" class="hidden space-y-5">
                <header class="flex items-center gap-2">
                  <div class="w-2 h-2 rounded-full bg-accent"></div>
                  <h2 class="heading text-slate-900 text-lg">Security Settings </h2>
                </header>

                <!-- Note: No password inputs here (demo) -->
                <div class="p-4 rounded-2xl bg-accent-light text-sm text-slate-700">
                  Password changes are not supported in this demo. You can request a password reset link instead.
                </div>

                <!-- 2FA Toggle -->
                <div class="p-4 rounded-2xl border border-gray-100 flex items-center justify-between">
                  <div>
                    <p class="font-medium">Enable Two-Factor Authentication (2FA)</p>
                    <p id="twofaStatus" class="text-sm text-grayish-600">Currently: Off</p>
                  </div>
                  <button id="twofaToggle" class="relative w-12 h-7 rounded-full bg-gray-200 toggle">
                    <span id="twofaKnob" class="absolute top-1 left-1 w-5 h-5 rounded-full bg-white shadow transition-all"></span>
                  </button>
                </div>

                <div class="flex flex-col sm:flex-row gap-3">
                  <button id="requestReset" class="px-5 py-2.5 rounded-xl border border-gray-200 hover:bg-grayish-100 font-medium"> Request Password Reset</button>
                  <button id="saveSecurity" class="btn-gradient px-5 py-2.5 rounded-xl font-medium">Save Security Settings</button>
                </div>
              </section>
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>

  <!-- Modal: Request Password Reset -->
  <div id="resetModal" class="hidden fixed inset-0 z-[70]">
    <div class="absolute inset-0 bg-black/30"></div>
    <div class="relative mx-auto mt-32 max-w-md w-[92%] card p-5">
      <h3 class="heading text-lg text-slate-900">Send password reset link?</h3>
      <p class="mt-1 text-sm text-grayish-600">We‚Äôll send a reset link to your current email on file.</p>
      <div class="mt-4 flex justify-end gap-2">
        <button id="cancelReset" class="px-4 py-2 rounded-xl border border-gray-200 hover:bg-grayish-100">Cancel</button>
        <button id="confirmReset" class="btn-gradient px-4 py-2 rounded-xl">Send Link</button>
      </div>
    </div>
  </div>

  <script>
    // Simple state
    let activeTab = 'personal';
    let hasPhoto = false;
    let twoFA = false;
    let idProofFile = null;

    // Tab elements
    const tabButtons = document.querySelectorAll('.tab-btn');
    const mobileTabs = document.getElementById('mobileTabs');
    const panels = {
      personal: document.getElementById('tab-personal'),
      academic: document.getElementById('tab-academic'),
      contact: document.getElementById('tab-contact'),
      security: document.getElementById('tab-security'),
    };

    function setActiveTab(tab) {
      activeTab = tab;
      // Update desktop tabs
      tabButtons.forEach(btn => {
        const isActive = btn.dataset.tab === tab;
        btn.classList.toggle('tab-active', isActive);
        btn.classList.toggle('border', true);
        btn.classList.toggle('border-transparent', !isActive);
        btn.classList.toggle('border-accent', isActive);
      });
      // Update panels
      Object.entries(panels).forEach(([key, el]) => {
        el.classList.toggle('hidden', key !== tab);
      });
      // Update mobile dropdown
      if (mobileTabs.value !== tab) mobileTabs.value = tab;
    }

    // Init default tab
    setActiveTab(activeTab);

    // Tab interactions
    tabButtons.forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        setActiveTab(btn.dataset.tab);
      });
    });
    mobileTabs.addEventListener('change', (e) => setActiveTab(e.target.value));

    // Topbar menus
    const notifBtn = document.getElementById('notifBtn');
    const notifMenu = document.getElementById('notifMenu');
    const clearNotifs = document.getElementById('clearNotifs');
    const profileBtn = document.getElementById('profileBtn');
    const profileMenu = document.getElementById('profileMenu');
    const notifDot = document.getElementById('notifDot');

    function toggleMenu(menuEl) {
      menuEl.classList.toggle('hidden');
    }
    notifBtn.addEventListener('click', () => {
      toggleMenu(notifMenu);
      profileMenu.classList.add('hidden');
    });
    profileBtn.addEventListener('click', () => {
      toggleMenu(profileMenu);
      notifMenu.classList.add('hidden');
    });
    document.addEventListener('click', (e) => {
      const insideTopbar = e.target.closest('#notifBtn, #notifMenu, #profileBtn, #profileMenu');
      if (!insideTopbar) {
        notifMenu.classList.add('hidden');
        profileMenu.classList.add('hidden');
      }
    });
    clearNotifs.addEventListener('click', () => {
      notifMenu.querySelector('ul').innerHTML = '<li class="p-2 rounded-lg bg-grayish-100 text-sm">All caught up üéâ</li>';
      notifDot.classList.add('hidden');
    });

    // Demo sign out
    document.getElementById('demoSignOut').addEventListener('click', () => showToast('Signed out (demo).'));

    // Toast helper
    function showToast(message) {
      const wrap = document.getElementById('toast');
      const item = document.createElement('div');
      item.className = 'toast-enter card px-4 py-3';
      item.innerHTML = `<div class="flex items-start gap-3">
        <div class="w-2 h-2 rounded-full bg-accent mt-1"></div>
        <div class="text-sm">${message}</div>
      </div>`;
      wrap.appendChild(item);
      setTimeout(() => {
        item.style.transition = 'opacity .25s ease';
        item.style.opacity = '0';
        setTimeout(() => wrap.removeChild(item), 250);
      }, 2200);
    }

    // Profile Avatar upload (no <img>, using background-image)
    const avatarBox = document.getElementById('avatarBox');
    const avatarIcon = document.getElementById('avatarIcon');
    const avatarInput = document.getElementById('avatarInput');
    const uploadAvatarBtn = document.getElementById('uploadAvatarBtn');

    uploadAvatarBtn.addEventListener('click', () => avatarInput.click());
    avatarInput.addEventListener('change', (e) => {
      const file = e.target.files && e.target.files[0];
      if (!file) return;
      if (!file.type.startsWith('image/')) { showToast('Please choose an image file.'); return; }
      const reader = new FileReader();
      reader.onload = (evt) => {
        avatarBox.style.backgroundImage = `url('${evt.target.result}')`;
        avatarBox.style.backgroundSize = 'cover';
        avatarBox.style.backgroundPosition = 'center';
        avatarIcon.style.display = 'none';
        hasPhoto = true;
        showToast('Profile photo updated.');
      };
      reader.readAsDataURL(file);
    });

    // Left "Edit Profile" jumps to Personal Info
    document.getElementById('editProfileBtn').addEventListener('click', () => {
      setActiveTab('personal');
      document.getElementById('pi-name').focus();
    });

    // Personal Info form
    const personalForm = document.getElementById('personalForm');
    const idProofInput = document.getElementById('idProofInput');
    const idProofBtn = document.getElementById('idProofBtn');
    const idProofName = document.getElementById('idProofName');
    const idProofClear = document.getElementById('idProofClear');

    idProofBtn.addEventListener('click', () => idProofInput.click());
    idProofInput.addEventListener('change', (e) => {
      idProofFile = e.target.files && e.target.files[0] ? e.target.files[0] : null;
      if (idProofFile) {
        idProofName.textContent = idProofFile.name;
        idProofClear.classList.remove('hidden');
      } else {
        idProofName.textContent = 'No file chosen';
        idProofClear.classList.add('hidden');
      }
    });
    idProofClear.addEventListener('click', () => {
      idProofInput.value = '';
      idProofFile = null;
      idProofName.textContent = 'No file chosen';
      idProofClear.classList.add('hidden');
    });

    personalForm.addEventListener('submit', (e) => {
      e.preventDefault();
      // Sync name to left card
      const nameVal = document.getElementById('pi-name').value.trim() || 'Student';
      document.getElementById('studentName').textContent = nameVal;
      // Optionally sync email/phone somewhere else as needed
      showToast('Personal info saved.');
    });

    // Contact form
    document.getElementById('contactForm').addEventListener('submit', (e) => {
      e.preventDefault();
      showToast('Contact details updated.');
    });

    // 2FA toggle
    const twofaToggle = document.getElementById('twofaToggle');
    const twofaKnob = document.getElementById('twofaKnob');
    const twofaStatus = document.getElementById('twofaStatus');

    function render2FA() {
      if (twoFA) {
        twofaToggle.classList.remove('bg-gray-200');
        twofaToggle.classList.add('bg-accent');
        twofaKnob.style.left = 'calc(100% - 1.25rem)'; // 1rem knob + 0.25rem margin
        twofaStatus.textContent = 'Currently: On';
      } else {
        twofaToggle.classList.add('bg-gray-200');
        twofaToggle.classList.remove('bg-accent');
        twofaKnob.style.left = '0.25rem';
        twofaStatus.textContent = 'Currently: Off';
      }
    }
    twofaToggle.addEventListener('click', () => {
      twoFA = !twoFA;
      render2FA();
    });
    render2FA();

    // Security actions
    const resetModal = document.getElementById('resetModal');
    document.getElementById('requestReset').addEventListener('click', () => {
      resetModal.classList.remove('hidden');
    });
    document.getElementById('cancelReset').addEventListener('click', () => {
      resetModal.classList.add('hidden');
    });
    document.getElementById('confirmReset').addEventListener('click', () => {
      resetModal.classList.add('hidden');
      const email = document.getElementById('pi-email').value || 'your email';
      showToast(`Password reset link sent to ${email}.`);
    });
    document.getElementById('saveSecurity').addEventListener('click', () => {
      showToast(`Security settings saved. 2FA: ${twoFA ? 'On' : 'Off'}.`);
    });

    // Accessibility: close modal on ESC / backdrop click
    resetModal.addEventListener('click', (e) => {
      if (e.target === resetModal) resetModal.classList.add('hidden');
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        resetModal.classList.add('hidden');
        notifMenu.classList.add('hidden');
        profileMenu.classList.add('hidden');
      }
    });
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'982220aec682a994',t:'MTc1ODM3OTc0OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
